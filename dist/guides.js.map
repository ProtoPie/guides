{"version":3,"file":"guides.js","sources":["../src/react-guides/utils.ts","../src/react-guides/consts.ts","../src/react-guides/Guides.tsx","../src/InnerGuides.tsx","../src/GuidesManager.tsx","../src/index.ts"],"sourcesContent":["import { prefixNames } from 'framework-utils';\n\nexport function prefix(...classNames: string[]) {\n    return prefixNames('scena-', ...classNames);\n}\n","import { PROPERTIES as RULER_PROPERTIES } from '@scena/react-ruler';\nimport { prefixCSS } from 'framework-utils';\n\nimport { GuidesOptions } from './types';\nimport { prefix } from './utils';\n\nexport const RULER = prefix('ruler');\nexport const ADDER = prefix('guide', 'adder');\nexport const GUIDES = prefix('guides');\nexport const GUIDE = prefix('guide');\nexport const DRAGGING = prefix('dragging');\nexport const DISPLAY_DRAG = prefix('display-drag');\nexport const GUIDES_CSS = prefixCSS('scena-', `\n{\n    position: relative;\n    width: 100%;\n    height: 100%;\n}\ncanvas {\n    position: relative;\n}\n.guide-origin {\n    position: absolute;\n    width: 1px;\n    height: 1px;\n    top: 0;\n    left: 0;\n    opacity: 0;\n}\n.guides {\n    position: absolute;\n    bottom: 0;\n    right: 0;\n    will-change: transform;\n    z-index: 2000;\n}\n.guide-pos {\n    position: absolute;\n    font-weight: bold;\n    font-size: 12px;\n    color: #E04169;\n    width: 50px;\n    text-align: center;\n    backdrop-filter: blur(20px);\n}\n\n.horizontal .guide-pos {\n    bottom: 100%;\n    left: 50%;\n    transform: translate(-50%);\n}\n.vertical .guide-pos {\n    left: calc(100% + 2px);\n    top: 10px;\n    transform: translateY(-50%);\n}\n.display-drag {\n    position: absolute;\n    z-index: 2000;\n    font-weight: bold;\n    font-size: 12px;\n    display: block;\n    color: #E04169;\n    backdrop-filter: blur(20px);\n}\n\n.horizontal .display-drag {\n    bottom: 100%;\n    left: 15px\n    transform: translate(-50%);\n}\n\n.vertical .display-drag {\n    left: calc(100% + 2px);\n    top: 10px;\n    transform: translateY(-50%);\n}\n\n:host.horizontal .guides {\n    width: 100%;\n    height: 0;\n}\n:host.vertical .guides {\n    height: 100%;\n    width: 0;\n}\n.guide {\n    position: absolute;\n    background: #f33;\n    z-index: 2;\n}\n.selected {\n    background: #8169FF;\n}\n.guide.dragging:before {\n    position: absolute;\n    content: \"\";\n    width: 100%;\n    height: 100%;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n:host.horizontal .guide {\n    width: 100%;\n    height: 1px;\n    cursor: row-resize;\n}\n:host.vertical .guide {\n    width: 1px;\n    height: 100%;\n    cursor: col-resize;\n}\n:host.horizontal .dragging,\n:host.horizontal .selected {\n    height: 2px\n}\n:host.vertical .dragging,\n:host.vertical .selected {\n    width: 2px\n}\n.mobile :host.horizontal .guide {\n    transform: scale(1, 2);\n}\n.mobile :host.vertical .guide {\n    transform: scale(2, 1);\n}\n:host.horizontal .guide:before {\n    height: 10px;\n    margin-top: -5px;\n    display: block;\n    content: '';\n}\n:host.vertical .guide:before {\n    width: 10px;\n    height: 100%;\n    margin-left: -5px;\n    display: block;\n    content: '';\n}\n.adder {\n    display: none;\n}\n.adder.dragging {\n    display: block;\n}\n`);\n\nexport const PROPERTIES: Array<keyof GuidesOptions> = [\n    'className',\n    'rulerStyle',\n    'snapThreshold',\n    'snaps',\n    'displayDragPos',\n    'cspNonce',\n    'dragPosFormat',\n    'defaultGuides',\n    'showGuides',\n    ...RULER_PROPERTIES,\n];\n\nexport const METHODS = [\n    'getGuides',\n    'loadGuides',\n    'scroll',\n    'scrollGuides',\n    'resize',\n    'deleteSelectedGuide',\n    'resetSelected',\n    'clearAllGuides',\n] as const;\n\nexport const EVENTS = [\n    'changeGuides',\n    'dragStart',\n    'drag',\n    'dragEnd',\n    'clickRuler',\n    'deleteGuide',\n    'addGuide',\n    'resetGuides',\n] as const;\n","import { addClass, hasClass, removeClass } from '@daybrush/utils';\nimport Ruler, { PROPERTIES as RULER_PROPERTIES, RulerProps } from '@scena/react-ruler';\nimport { calculateMatrixDist,getDistElementMatrix } from 'css-to-mat';\nimport { ref, refs } from 'framework-utils';\nimport Gesto, { OnDragEnd } from 'gesto';\nimport * as React from 'react';\nimport styled, { StyledElement } from 'react-css-styled';\n\nimport { ADDER, DISPLAY_DRAG, DRAGGING, GUIDE, GUIDES, GUIDES_CSS } from './consts';\nimport { GuidesInterface,GuidesProps, GuidesState, OnDragStart } from './types';\nimport { prefix } from './utils';\n\nconst GuidesElement = styled('div', GUIDES_CSS);\n\nexport default class Guides extends React.PureComponent<GuidesProps, GuidesState> implements GuidesInterface {\n    public static defaultProps: GuidesProps = {\n        className: '',\n        type: 'horizontal',\n        zoom: 1,\n        style: {},\n        snapThreshold: 5,\n        snaps: [],\n        digit: 0,\n        onClickRuler: () => { },\n        onAddGuide: () => { },        \n        onDeleteGuide: () => { },\n        onChangeGuides: () => { },\n        onDragStart: () => { },\n        onDrag: () => { },\n        onDragEnd: () => { },\n        displayDragPos: false,\n        dragPosFormat: v => v,\n        defaultGuides: [],\n        lockGuides: false,\n        showGuides: true,\n        guideStyle: {},\n        dragGuideStyle: {},\n        guidePosStyle: {},\n        portalContainer: null,\n    };\n    public state: GuidesState = {\n        guides: [],\n        selectedGuides: [],\n    };\n    public adderElement!: HTMLElement;\n    public scrollPos = 0;\n    public ruler!: Ruler;\n    private manager!: StyledElement<HTMLElement>;\n    private guidesElement!: HTMLElement;\n    private displayElement!: HTMLElement;\n    private originElement!: HTMLElement;\n    private gesto!: Gesto;\n    private guideElements: HTMLElement[] = [];\n    private _isFirstMove = false;\n    private _pointerEventsTimer: NodeJS.Timeout;\n\n    constructor(props: Required<GuidesProps>) {\n        super(props);\n        window.addEventListener('keydown', (e: KeyboardEvent) => {\n            if(e.code === 'Backspace' && this.state.selectedGuides.length) {\n                this.deleteSelectedGuide();\n            }\n        });\n\n        window.addEventListener('click', (e: MouseEvent) => {\n            this.resetSelected();\n            e.stopPropagation();\n        });\n    }\n\n    public disablePointerEventsOnScroll() {\n        if(!this.props?.showGuides) {\n            return;\n        }\n        this._pointerEventsTimer && clearTimeout(this._pointerEventsTimer);\n        this.guidesElement.style.pointerEvents = 'none';\n        this._pointerEventsTimer = setTimeout(() => {\n            this.guidesElement.style.pointerEvents = 'auto';\n        }, 300);\n    }\n\n    public render() {\n        const {\n            className,\n            type,\n            zoom,\n            style,\n            rulerStyle,\n            displayDragPos,\n            cspNonce,\n            dragGuideStyle,\n            portalContainer,\n        } = this.props as Required<GuidesProps>;\n        const props = this.props;\n        const translateName = this.getTranslateName();\n\n        const rulerProps: RulerProps = {};\n\n        RULER_PROPERTIES.forEach(name => {\n            if (name === 'style') {\n                return;\n            }\n            (rulerProps as any)[name] = props[name];\n        });\n        return <GuidesElement\n            ref={ref(this, 'manager')}\n            cspNonce={cspNonce}\n            className={`${prefix('manager', type)} ${className}`}\n            portalContainer={portalContainer}\n            style={style}\n        >\n            <div className={prefix('guide-origin')} ref={ref(this, 'originElement')}></div>\n            <Ruler\n                ref={ref(this, 'ruler')}\n                style={rulerStyle}\n                {...rulerProps}\n            />\n            <div className={GUIDES} ref={ref(this, 'guidesElement')} style={{\n                transform: `${translateName}(${-this.scrollPos * zoom}px)`,\n            }}>\n                {displayDragPos && <div className={DISPLAY_DRAG}\n                    ref={ref(this, 'displayElement')} style={dragGuideStyle} />}\n                <div className={ADDER} ref={ref(this, 'adderElement')} />\n                {this.renderGuides()}\n            </div>\n        </GuidesElement>;\n    }\n\n    private selectGuide(pos: number, e: React.MouseEvent<HTMLDivElement, MouseEvent>) {\n        this.setState({\n            selectedGuides: [pos],\n        });\n        e.stopPropagation();\n        e.preventDefault();\n    }\n\n    public renderGuides() {\n        const props = this.props;\n        const {\n            type,\n            zoom,\n            showGuides,\n            guideStyle,\n            displayGuidePos,\n            guidePosStyle = {},\n        } = props as Required<GuidesProps>;\n        const translateName = this.getTranslateName();\n        const guides = this.state.guides;\n        const guidePosFormat = props.guidePosFormat || props.dragPosFormat || (v => v);\n        const selectedGuides = this.state.selectedGuides;\n        this.guideElements = [];\n        if (showGuides) {\n            return guides.map((pos, i) => {\n                return (\n                    <div className={`${prefix('guide', type)} ${selectedGuides.includes(pos) ? prefix('selected') : ''}`}\n                        ref={refs(this, 'guideElements', i)}\n                        key={i}\n                        data-index={i}\n                        data-pos={pos}\n                        onClick={(e) => this.selectGuide(pos, e)}\n                        style={{\n                            ...guideStyle,\n                            transform: `${translateName}(${pos * zoom}px) translateZ(0px)`,\n                        }}>\n                            {displayGuidePos && <div className={prefix('guide-pos')} style={guidePosStyle || {}}>\n                                {guidePosFormat!(pos)}\n                            </div>}\n                        </div>\n                    );\n            });\n        }\n        return;\n    }\n    public componentDidMount() {\n        this.gesto = new Gesto(this.manager.getElement(), {\n            container: document.body,\n        }).on('dragStart', e => {\n            const {\n                type,\n                zoom,\n                lockGuides,\n            } = this.props;\n\n            if (lockGuides === true) {\n                e.stop();\n                return;\n            }\n            const inputEvent = e.inputEvent;\n            const target = inputEvent.target;\n            const datas = e.datas;\n            const canvasElement = this.ruler.canvasElement;\n            const guidesElement = this.guidesElement;\n            const isHorizontal = type === 'horizontal';\n            const originRect = this.originElement.getBoundingClientRect();\n            const matrix = getDistElementMatrix(this.manager.getElement());\n            const offsetPos = calculateMatrixDist(matrix, [\n                e.clientX - originRect.left,\n                e.clientY - originRect.top,\n            ]);\n            offsetPos[0] -= guidesElement.offsetLeft;\n            offsetPos[1] -= guidesElement.offsetTop;\n            offsetPos[isHorizontal ? 1 : 0] += this.scrollPos * zoom!;\n\n            datas.offsetPos = offsetPos;\n            datas.matrix = matrix;\n\n            const isLockAdd = lockGuides && lockGuides.indexOf('add') > -1;\n            const isLockRemove = lockGuides && lockGuides.indexOf('remove') > -1;\n            const isLockChange = lockGuides && lockGuides.indexOf('change') > -1;\n\n            if (target === canvasElement) {\n                if (isLockAdd) {\n                    e.stop();\n                    return;\n                }\n                datas.fromRuler = true;\n                datas.target = this.adderElement;\n                // add\n            } else if (hasClass(target, GUIDE)) {\n                if (isLockRemove && isLockChange) {\n                    e.stop();\n                    return;\n                }\n                datas.target = target;\n                // change\n            } else {\n                e.stop();\n                return false;\n            }\n            this.onDragStart(e as OnDragStart);\n        }).on('drag', this.onDrag).on('dragEnd', this.onDragEnd);\n        // pass array of guides on mount data to create gridlines or something like that in ui\n        this.setState({ guides: this.props.defaultGuides || [] });\n    }\n    public componentWillUnmount() {\n        this.gesto.unset();\n    }\n    public componentDidUpdate(prevProps: any) {\n        if (prevProps.defaultGuides !== this.props.defaultGuides) {\n            // to dynamically update guides from code rather than dragging guidelines\n            this.setState({ guides: this.props.defaultGuides || [] });\n        }\n    }\n    /**\n     * Load the current guidelines.\n     * @memberof Guides\n     * @instance\n     */\n    public loadGuides(guides: number[]) {\n        this.setState({\n            guides,\n        });\n    }\n\n    /**\n     * Delete the selected guideline.\n     * @memberof Guides\n     * @instance\n     */\n    public deleteSelectedGuide() {\n        const guides = this.getGuides();\n        const guidesClone = this.getGuides();\n        const index = guides.findIndex(guide => {\n            if(this.state.selectedGuides.includes(guide)) {\n                return guide;\n            }\n        });\n\n        guides.splice(index, 1);\n        \n        this.setState({\n            guides,\n            selectedGuides: [],\n        });\n        \n        this.props.onDeleteGuide!({\n            deletedPosGuide: guidesClone[index],\n            deletedIndexGuide: index,\n        });\n    }\n\n    /**\n     * Clear all guidelines\n     * @memberof Guides\n     * @instance\n     */\n    public clearAllGuides() {\n        this.setState({\n            guides: [],\n        });\n    }\n\n    /**\n     * Get current guidelines.\n     * @memberof Guides\n     * @instance\n     */\n    public getGuides(): number[] {\n        return this.state.guides;\n    }\n    /**\n     * Scroll the positions of the guidelines opposite the ruler.\n     * @memberof Guides\n     * @instance\n     */\n    public scrollGuides(pos: number, zoom = 1) {\n        const guidesElement = this.guidesElement;\n\n        this.disablePointerEventsOnScroll();\n\n        this.scrollPos = pos;\n        guidesElement.style.transform = `${this.getTranslateName()}(${-pos * zoom}px)`;\n\n        const guides = this.state.guides;\n        this.guideElements.forEach((el, i) => {\n            if (!el) {\n                return;\n            }\n            el.style.display = -pos + guides[i] < 0 ? 'none' : 'block';\n        });\n    }\n    /**\n     * Recalculate the size of the ruler.\n     * @memberof Guides\n     * @instance\n     */\n    public resize() {\n        this.ruler.resize();\n    }\n    /**\n     * Scroll the position of the ruler.\n     * @memberof Guides\n     * @instance\n     */\n    public scroll(pos: number) {\n        this.ruler.scroll(pos);\n    }\n\n    private onDragStart = (e: OnDragStart) => {\n        this.resetSelected();\n        this.props.onDragStart(e);\n        this._isFirstMove = true;\n    }\n\n    private onDrag = (e: any) => { \n        if (this._isFirstMove) {\n            this._isFirstMove = false;\n            addClass(e.datas.target, DRAGGING);\n        }\n        const nextPos = this.movePos(e);\n\n        /**\n         * When dragging, the drag event is called.\n         * @memberof Guides\n         * @event drag\n         * @param {OnDrag} - Parameters for the drag event\n         */\n        this.props.onDrag!({\n            ...e,\n            dragElement: e.datas.target,\n        });\n        return nextPos;\n    }\n    private onDragEnd = (e: OnDragEnd) => {\n        const { datas, isDrag, distX, distY } = e;\n\n        if(!isDrag) {\n            return;\n        }\n\n        const pos = this.movePos(e);\n        let guides = this.state.guides;\n        const { onChangeGuides, onAddGuide, zoom, displayDragPos, digit, lockGuides } = this.props;\n        const guidePos = parseFloat((pos / zoom!).toFixed(digit || 0));\n\n        if (displayDragPos) {\n            this.displayElement.style.cssText += 'display: none;';\n        }\n\n        removeClass(datas.target, DRAGGING);\n        if (datas.fromRuler) {\n            if (this._isFirstMove) {\n                /**\n                 * When click the ruler, the click ruler is called.\n                 * @memberof Guides\n                 * @event clickRuler\n                 * @param {OnClickRuler} - Parameters for the clickRuler event\n                 */\n                this.props.onClickRuler!({\n                    ...e,\n                    pos: 0,\n                });\n            }\n            if (guidePos >= this.scrollPos && guides.indexOf(guidePos) < 0) {\n                this.setState({\n                    guides: [...guides, guidePos],\n                }, () => {\n                    /**\n                     * The `changeGuides` event occurs when the guideline is added / removed / changed.\n                     * @memberof Guides\n                     * @event changeGuides\n                     * @param {OnChangeGuides} - Parameters for the changeGuides event\n                     */\n                    onChangeGuides!({\n                        guides: this.state.guides,\n                        distX,\n                        distY,\n                        isAdd: true,\n                        isRemove: false,\n                        isChange: false,\n                    });\n\n                    onAddGuide!({\n                        posNewGuide: guidePos,\n                    });\n                });\n            }\n        } else {\n            const index = datas.target.getAttribute('data-index');\n            let isRemove = false;\n            let isChange = false;\n\n            guides = [...guides];\n\n            if (guidePos < this.scrollPos) {\n                if (lockGuides && (lockGuides === true || lockGuides.indexOf('remove') > -1)) {\n                    return;\n                }\n                const deletedPosGuide = guides[index];\n                guides.splice(index, 1);\n                this.props.onDeleteGuide!({\n                    deletedIndexGuide: index,\n                    deletedPosGuide,\n                });\n                isRemove = true;\n            } else if (guides.indexOf(guidePos) > -1) {\n                return;\n            } else {\n                if (lockGuides && (lockGuides === true || lockGuides.indexOf('change') > -1)) {\n                    return;\n                }\n                guides[index] = guidePos;\n                isChange = true;\n            }\n            this.setState({\n                guides,\n            }, () => {\n                const nextGuides = this.state.guides;\n                onChangeGuides!({\n                    distX,\n                    distY,\n                    guides: nextGuides,\n                    isAdd: false,\n                    isChange,\n                    isRemove,\n                });\n            });\n        }\n\n        /**\n         * When the drag finishes, the dragEnd event is called.\n         * @memberof Guides\n         * @event dragEnd\n         * @param {OnDragEnd} - Parameters for the dragEnd event\n         */\n            this.props.onDragEnd!({\n                ...e,\n                dragElement: datas.target,\n            });\n    }\n    private movePos(e: any) {\n        const { datas, distX, distY } = e;\n        const props = this.props;\n        const {\n            type, zoom, snaps, snapThreshold,\n            displayDragPos,\n            digit,\n        } = props;\n        const dragPosFormat = props.dragPosFormat || (v => v);\n        const isHorizontal = type === 'horizontal';\n        const matrixPos = calculateMatrixDist(datas.matrix, [distX, distY]);\n        const offsetPos = datas.offsetPos;\n        const offsetX = matrixPos[0] + offsetPos[0];\n        const offsetY = matrixPos[1] + offsetPos[1];\n        let nextPos = Math.round(isHorizontal ? offsetY : offsetX);\n        let guidePos = parseFloat((nextPos / zoom!).toFixed(digit || 0));\n        const guideSnaps = snaps!.slice().sort((a, b) => {\n            return Math.abs(guidePos - a) - Math.abs(guidePos - b);\n        });\n\n        if (guideSnaps.length && Math.abs(guideSnaps[0] * zoom! - nextPos) < snapThreshold!) {\n            guidePos = guideSnaps[0];\n            nextPos = guidePos * zoom!;\n        }\n        if (!datas.fromRuler || !this._isFirstMove) {\n            if (displayDragPos) {\n                const displayPos = type === 'horizontal'\n                ? [offsetX, nextPos]\n                : [nextPos, offsetY];\n                const transform = type === 'horizontal' \n                    ? `translate(${displayPos.map((v, i) => !i ? '-6px' : `${v - 13}px` ).join(', ')}) rotate(-90deg)` \n                    : `translate(${displayPos.map((v, i) => !i ? `${v + 16}px` : '9px' ).join(', ')})`;\n                this.displayElement.style.cssText += 'display: block;'\n                    + 'transform: translate(-50%, -50%) '\n                    + transform;\n                this.displayElement.innerHTML = `${dragPosFormat!(guidePos)}`;\n            }\n            const target = datas.target;\n\n            target.setAttribute('data-pos', guidePos);\n            target.style.transform = `${this.getTranslateName()}(${nextPos}px)`;\n        }\n\n        return nextPos;\n\n    }\n    private getTranslateName() {\n        return this.props.type === 'horizontal' ? 'translateY' : 'translateX';\n    }\n\n    public resetSelected() {\n        this.setState({\n            selectedGuides:[],\n        });\n    }\n}\n","import { ref } from 'framework-utils';\nimport * as React from 'react';\nimport { createPortal } from 'react-dom';\n\nimport ReactGuides from './react-guides';\nimport { GuidesOptions } from './react-guides/types';\n\nexport interface InnerGuidesProps extends GuidesOptions {\n    container?: HTMLElement;\n}\nexport default class InnerGuides extends React.Component<InnerGuidesProps, InnerGuidesProps> {\n    public state: InnerGuidesProps = {};\n    public guides: ReactGuides;\n    constructor(props: InnerGuidesProps) {\n        super(props);\n        this.state = { ...props };\n    }\n    public render() {\n        const { container, ...state } = this.state;\n        return createPortal(<ReactGuides ref={ref(this, 'guides')} {...state} />, container);\n    }\n}\n","import { camelize } from '@daybrush/utils';\nimport EventEmitter from '@scena/event-emitter';\nimport { Properties,ref } from 'framework-utils';\nimport * as React from 'react';\nimport { render } from 'react-dom';\n\nimport InnerGuides from './InnerGuides';\nimport { EVENTS,METHODS, PROPERTIES } from './react-guides/consts';\nimport { GuidesEvents, GuidesInterface, GuidesOptions } from './react-guides/types';\n\n@Properties(METHODS as any, (prototype, property) => {\n    if (prototype[property]) {\n        return;\n    }\n    prototype[property] = function(...args) {\n        const self = this.getInnerGuides();\n\n        if (!self || !self[property]) {\n            return;\n        }\n        return self[property](...args);\n    };\n})\n@Properties(PROPERTIES, (prototype, property) => {\n    Object.defineProperty(prototype, property, {\n        get() {\n            return this.getInnerGuides().props[property];\n        },\n        set(value) {\n            this.innerGuides.setState({\n                [property]: value,\n            });\n        },\n        enumerable: true,\n        configurable: true,\n    });\n})\n/**\n * @sort 1\n * @extends EventEmitter\n */\nclass Guides extends EventEmitter<GuidesEvents> {\n    private tempElement = document.createElement('div');\n    private innerGuides!: InnerGuides;\n    /**\n     * @sort 1\n     * @param - guides' container\n     * @param {$ts:Partial<Guides.GuidesOptions>} - guides' options\n     */\n    constructor(container: HTMLElement, options: Partial<GuidesOptions> = {}) {\n        super();\n        const events: any = {};\n\n        EVENTS.forEach(name => {\n            events[camelize(`on ${name}`)] = (e: any) => this.trigger(name as any, e);\n        });\n\n        render(\n            <InnerGuides  {...options} {...events} container={container} ref={ref(this, 'innerGuides')} />,\n            this.tempElement,\n        );\n    }\n    /**\n     * @param state\n     * @param callback\n     */\n    public setState(state: Partial<GuidesOptions>, callback?: () => void) {\n        this.innerGuides.setState(state, callback);\n    }\n    /**\n     * destroy guides\n     */\n    public destroy() {\n        render(null, this.tempElement);\n        this.tempElement = null;\n        this.innerGuides = null;\n    }\n    private getInnerGuides() {\n        return this.innerGuides.guides;\n    }\n}\ninterface Guides extends GuidesInterface {}\n\nexport default Guides;\n","import GuidesManager from './GuidesManager';\n\nexport * from './react-guides/types';\nexport default class Guides extends GuidesManager {}\n\n"],"names":["prefix","_i","classNames","prefixNames","RULER","ADDER","GUIDES","GUIDE","DRAGGING","DISPLAY_DRAG","GUIDES_CSS","prefixCSS","PROPERTIES","RULER_PROPERTIES","METHODS","EVENTS","GuidesElement","styled","__extends","props","_super","_this","guides","selectedGuides","e","resetSelected","onDragStart","_isFirstMove","addClass","datas","target","nextPos","movePos","onDrag","dragElement","isDrag","distX","distY","pos","state","_a","onChangeGuides","onAddGuide","zoom","displayDragPos","digit","lockGuides","guidePos","parseFloat","toFixed","displayElement","style","cssText","removeClass","fromRuler","onClickRuler","scrollPos","indexOf","setState","isAdd","isRemove","isChange","posNewGuide","index","getAttribute","isRemove_1","isChange_1","deletedPosGuide","splice","onDeleteGuide","deletedIndexGuide","nextGuides","onDragEnd","window","addEventListener","code","length","deleteSelectedGuide","stopPropagation","showGuides","_pointerEventsTimer","clearTimeout","guidesElement","pointerEvents","setTimeout","className","type","rulerStyle","cspNonce","dragGuideStyle","portalContainer","translateName","getTranslateName","rulerProps","forEach","name","React","ref","Ruler","transform","renderGuides","preventDefault","guideStyle","displayGuidePos","_b","guidePosStyle","guidePosFormat","dragPosFormat","v","guideElements","map","i","includes","refs","key","onClick","selectGuide","gesto","Gesto","manager","getElement","container","document","body","on","stop","inputEvent","canvasElement","ruler","isHorizontal","originRect","originElement","getBoundingClientRect","matrix","getDistElementMatrix","offsetPos","calculateMatrixDist","clientX","left","clientY","top","offsetLeft","offsetTop","isLockAdd","isLockRemove","isLockChange","adderElement","hasClass","defaultGuides","unset","prevProps","getGuides","guidesClone","findIndex","guide","disablePointerEventsOnScroll","el","display","resize","scroll","snaps","snapThreshold","matrixPos","offsetX","offsetY","Math","round","guideSnaps","slice","sort","a","b","abs","displayPos","join","innerHTML","setAttribute","Guides","createPortal","ReactGuides","options","createElement","events","camelize","trigger","render","InnerGuides","tempElement","callback","innerGuides","Properties","prototype","property","args","self","getInnerGuides","Object","defineProperty","get","set","value","enumerable","configurable","EventEmitter","GuidesManager"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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"}